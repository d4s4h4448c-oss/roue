<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roue Discord Al√©atoire</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé°</text></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #5865F2;
            --secondary-color: #2C2F33;
            --accent-color: #7289DA;
            --background-color: #f5f7fa;
            --text-color: #2C2F33;
            --light-gray: #e0e0e0;
            --success-color: #43b581;
            --danger-color: #f04747;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        header {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .panel {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .wheel-container {
            flex: 2;
            min-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .panel h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .wheel-wrapper {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 20px auto;
        }

        #wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 0 10px var(--primary-color), 0 0 30px rgba(0, 0, 0, 0.2);
            transition: transform 4s cubic-bezier(0.2, 0.8, 0.3, 1);
            background-color: white;
        }

        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background-color: white;
            border-radius: 50%;
            z-index: 100;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1.2rem;
            border: 5px solid var(--primary-color);
            cursor: pointer;
        }

        .wheel-pointer {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 60px;
            z-index: 150;
        }

        .wheel-pointer:before {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid var(--danger-color);
        }

        .segment-line {
            position: absolute;
            width: 2px;
            height: 50%;
            top: 0;
            left: 50%;
            background-color: #666;
            transform-origin: 50% 100%;
            z-index: 5;
        }

        .pseudo-label {
            position: absolute;
            color: white;
            font-weight: bold;
            font-size: 18px;
            white-space: nowrap;
            pointer-events: none;
            z-index: 10;
            text-align: center;
            transform-origin: 0 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn:focus, .pseudo-color:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(88, 101, 242, 0.3);
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-secondary {
            background-color: var(--light-gray);
            color: var(--text-color);
        }

        #pseudo-input {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 2px solid var(--light-gray);
            border-radius: 10px;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 20px;
        }

        .pseudo-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--light-gray);
            border-radius: 10px;
            padding: 10px;
            margin-top: 20px;
        }

        .pseudo-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        .pseudo-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 15px;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 3px rgba(0,0,0,0.3);
        }

        .pseudo-name {
            flex-grow: 1;
            font-weight: 500;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 200px;
        }

        .pseudo-actions {
            display: flex;
            gap: 8px;
        }

        .pseudo-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result {
            text-align: center;
            padding: 20px;
            background-color: white;
            border-radius: 15px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        #selected-pseudo {
            font-size: 2.5rem;
            font-weight: bold;
            padding: 20px;
            border-radius: 10px;
            background-color: #f9f9f9;
            margin: 20px 0;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .history {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 10px;
            max-height: 150px;
            overflow-y: auto;
        }

        @media (max-width: 1100px) {
            .main-content {
                flex-direction: column;
            }
            
            .wheel-wrapper {
                width: 400px;
                height: 400px;
            }
        }

        @media (max-width: 600px) {
            .wheel-wrapper {
                width: 300px;
                height: 300px;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .pseudo-label {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-dharmachakra"></i> Roue Discord Al√©atoire</h1>
            <p>S√©lectionnez al√©atoirement des pseudos Discord avec cette roue interactive</p>
        </header>

        <div class="main-content">
            <div class="panel">
                <h2><i class="fas fa-users"></i> Gestion des Pseudos</h2>
                <textarea id="pseudo-input" placeholder="Entrez un pseudo par ligne ou collez une liste depuis Discord..."></textarea>
                
                <div class="controls">
                    <button id="add-pseudos-btn" class="btn btn-primary">
                        <i class="fas fa-plus-circle"></i> Ajouter
                    </button>
                    <button id="clear-all-btn" class="btn btn-danger">
                        <i class="fas fa-trash-alt"></i> Tout effacer
                    </button>
                </div>

                <div id="pseudo-list-container" class="pseudo-list">
                    <!-- Les pseudos seront ajout√©s ici -->
                </div>
            </div>

            <div class="wheel-container">
                <h2><i class="fas fa-dharmachakra"></i> Roue de S√©lection</h2>
                <div class="wheel-wrapper">
                    <div id="wheel"></div>
                    <div class="wheel-center" id="spin-center">TOURNEZ!</div>
                    <div class="wheel-pointer"></div>
                </div>
                
                <div class="controls">
                    <button id="spin-btn" class="btn btn-primary">
                        <i class="fas fa-play"></i> Tourner la roue
                    </button>
                    <button id="reset-wheel-btn" class="btn btn-secondary">
                        <i class="fas fa-redo"></i> R√©initialiser
                    </button>
                </div>
            </div>

            <div class="panel">
                <h2><i class="fas fa-cog"></i> Param√®tres</h2>
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 10px;">Action apr√®s s√©lection</h3>
                    <div style="display: flex; gap: 10px;">
                        <button id="keep-after-spin" class="btn btn-primary" style="flex: 1;">
                            <i class="fas fa-check-circle"></i> Garder
                        </button>
                        <button id="remove-after-spin" class="btn btn-secondary" style="flex: 1;">
                            <i class="fas fa-minus-circle"></i> Retirer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="result">
            <h2><i class="fas fa-trophy"></i> R√©sultat</h2>
            <div id="selected-pseudo">La roue n'a pas encore √©t√© tourn√©e</div>
            
            <div class="history">
                <h3>Historique des s√©lections</h3>
                <div id="history-list"></div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales - TOUJOURS initialis√©es √† vide
        let pseudos = [];
        let history = [];
        let removeAfterSpin = false;
        let isSpinning = false;
        let currentRotation = 0;

        // Couleurs pour les pseudos dans la liste
        const colors = [
            '#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0', '#118AB2',
            '#7209B7', '#3A86FF', '#FB5607', '#8338EC', '#FF006E'
        ];

        // √âl√©ments DOM
        const wheel = document.getElementById('wheel');
        const pseudoInput = document.getElementById('pseudo-input');
        const pseudoListContainer = document.getElementById('pseudo-list-container');
        const selectedPseudoDisplay = document.getElementById('selected-pseudo');
        const historyList = document.getElementById('history-list');
        const spinCenter = document.getElementById('spin-center');
        const spinBtn = document.getElementById('spin-btn');

        // Initialisation - NE CHARGE RIEN du localStorage
        document.addEventListener('DOMContentLoaded', function() {
            // Ne pas charger depuis localStorage - toujours partir de z√©ro
            // loadFromLocalStorage(); // LIGNE SUPPRIM√âE
            
            updatePseudoList();
            updateWheel();
            
            // √âv√©nements
            document.getElementById('add-pseudos-btn').addEventListener('click', addPseudosFromInput);
            document.getElementById('clear-all-btn').addEventListener('click', clearAllPseudos);
            spinBtn.addEventListener('click', spinWheel);
            document.getElementById('reset-wheel-btn').addEventListener('click', resetWheel);
            spinCenter.addEventListener('click', spinWheel);
            document.getElementById('keep-after-spin').addEventListener('click', () => setRemoveAfterSpin(false));
            document.getElementById('remove-after-spin').addEventListener('click', () => setRemoveAfterSpin(true));
            
            // Ajouter des exemples si vide
            if (pseudos.length === 0) {
                addExamplePseudos();
            }
        });

        // Ajouter des pseudos d'exemple
        function addExamplePseudos() {
            const examples = ["JeanClaude", "Gemini", "Alice", "Bob", "Charlie"];
            
            examples.forEach(name => {
                pseudos.push({
                    id: generateId(),
                    name: name,
                    color: colors[pseudos.length % colors.length],
                    enabled: true
                });
            });
            
            updatePseudoList();
            updateWheel();
        }

        // G√©n√©rer un ID unique
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // Ajouter des pseudos depuis l'input
        function addPseudosFromInput() {
            const input = pseudoInput.value.trim();
            if (!input) return;
            
            const newPseudos = input.split('\n')
                .map(p => p.trim())
                .filter(p => p.length > 0)
                .filter(p => !pseudos.some(existing => existing.name.toLowerCase() === p.toLowerCase()));
            
            newPseudos.forEach(name => {
                pseudos.push({
                    id: generateId(),
                    name: name,
                    color: colors[pseudos.length % colors.length],
                    enabled: true
                });
            });
            
            pseudoInput.value = '';
            updatePseudoList();
            updateWheel();
            showFeedback(`${newPseudos.length} pseudos ajout√©s`);
        }

        // Mettre √† jour la liste des pseudos
        function updatePseudoList() {
            if (pseudos.length === 0) {
                pseudoListContainer.innerHTML = '<div style="text-align: center; padding: 30px; color: #999;">Aucun pseudo</div>';
                return;
            }
            
            let html = '';
            pseudos.forEach(pseudo => {
                html += `
                <div class="pseudo-item" data-id="${pseudo.id}">
                    <div style="display: flex; align-items: center;">
                        <div class="pseudo-color" style="background-color: ${pseudo.color};" 
                             onclick="changeColor('${pseudo.id}')" title="Cliquer pour changer la couleur"></div>
                        <span class="pseudo-name">${pseudo.name}</span>
                    </div>
                    <div class="pseudo-actions">
                        <button onclick="removePseudo('${pseudo.id}')" title="Retirer de la roue">
                            <i class="fas fa-times" style="color: var(--danger-color);"></i>
                        </button>
                    </div>
                </div>
                `;
            });
            pseudoListContainer.innerHTML = html;
        }

        // Changer la couleur d'un pseudo
        function changeColor(id) {
            const pseudo = pseudos.find(p => p.id === id);
            if (pseudo) {
                const hue = Math.floor(Math.random() * 360);
                pseudo.color = `hsl(${hue}, 80%, 60%)`;
                updatePseudoList();
                updateWheel();
            }
        }

        // Retirer un pseudo
        function removePseudo(id) {
            pseudos = pseudos.filter(p => p.id !== id);
            updatePseudoList();
            updateWheel();
            showFeedback("Pseudo retir√©");
        }

        // Effacer tous les pseudos
        function clearAllPseudos() {
            if (pseudos.length === 0) return;
            if (confirm("Effacer tous les pseudos ?")) {
                pseudos = [];
                history = []; // Effacer aussi l'historique
                updatePseudoList();
                updateWheel();
                updateHistory();
                resetWheel();
                showFeedback("Tout a √©t√© effac√©");
                
                // R√©ajouter les exemples apr√®s suppression
                setTimeout(() => {
                    if (pseudos.length === 0) {
                        addExamplePseudos();
                    }
                }, 100);
            }
        }

        // Mettre √† jour la roue
        function updateWheel() {
            wheel.innerHTML = '';
            const enabledPseudos = pseudos.filter(p => p.enabled);

            if (enabledPseudos.length === 0) {
                wheel.innerHTML = '<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #999; text-align: center; font-size: 1.2rem;">Ajoutez des pseudos</div>';
                spinCenter.innerHTML = 'AJOUTEZ<br>DES PSEUDOS';
                spinBtn.disabled = true;
                return;
            }

            spinBtn.disabled = false;
            const segmentAngle = 360 / enabledPseudos.length;
            
            // Cr√©er les lignes de s√©paration et les labels
            enabledPseudos.forEach((pseudo, index) => {
                const angle = index * segmentAngle;
                
                // Segment color√©
                const segment = document.createElement('div');
                segment.style.position = 'absolute';
                segment.style.width = '100%';
                segment.style.height = '100%';
                segment.style.background = `conic-gradient(
                    transparent ${angle}deg,
                    ${pseudo.color}40 ${angle}deg,
                    ${pseudo.color}40 ${angle + segmentAngle}deg,
                    transparent ${angle + segmentAngle}deg
                )`;
                wheel.appendChild(segment);
                
                // Ligne de s√©paration
                const line = document.createElement('div');
                line.className = 'segment-line';
                line.style.transform = `rotate(${angle}deg)`;
                wheel.appendChild(line);
                
                // Label du pseudo
                const label = document.createElement('div');
                label.className = 'pseudo-label';
                label.textContent = pseudo.name;
                label.style.color = pseudo.color;
                label.style.fontSize = Math.max(16, 200 / enabledPseudos.length) + 'px';
                
                // Positionner le label au milieu du segment
                const labelAngle = angle + (segmentAngle / 2);
                const radius = 180; // Distance du centre
                
                label.style.left = '50%';
                label.style.top = '50%';
                label.style.transform = `
                    translate(-50%, -50%)
                    rotate(${labelAngle}deg)
                    translate(0, -${radius * 0.65}px)
                    rotate(-${labelAngle}deg)
                `;
                
                wheel.appendChild(label);
            });

            // Ajouter la derni√®re ligne de s√©paration
            const lastLine = document.createElement('div');
            lastLine.className = 'segment-line';
            lastLine.style.transform = `rotate(${enabledPseudos.length * segmentAngle}deg)`;
            wheel.appendChild(lastLine);

            spinCenter.innerHTML = 'TOURNEZ!';
        }

        // Faire tourner la roue
        function spinWheel() {
            if (isSpinning || pseudos.length === 0) return;
            
            const enabledPseudos = pseudos.filter(p => p.enabled);
            if (enabledPseudos.length === 0) return;
            
            isSpinning = true;
            spinBtn.disabled = true;
            spinBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> En cours...';
            spinCenter.innerHTML = '...';
            
            // R√©initialiser la transition pour repartir de la position actuelle
            wheel.style.transition = 'none';
            
            // Normaliser la rotation actuelle entre 0 et 360
            const normalizedCurrentRotation = currentRotation % 360;
            wheel.style.transform = `rotate(${normalizedCurrentRotation}deg)`;
            
            // Forcer un reflow pour appliquer la rotation imm√©diate
            void wheel.offsetWidth;
            
            // R√©activer la transition
            wheel.style.transition = `transform 4s cubic-bezier(0.2, 0.8, 0.3, 1)`;
            
            // 1. Choisir un segment au hasard
            const selectedIndex = Math.floor(Math.random() * enabledPseudos.length);
            const selectedPseudo = enabledPseudos[selectedIndex];
            const segmentAngle = 360 / enabledPseudos.length;
            
            // 2. Calculer o√π s'arr√™ter dans ce segment
            const segmentStart = selectedIndex * segmentAngle;
            const margin = segmentAngle * 0.1;
            const randomPositionInSegment = segmentStart + margin + (Math.random() * (segmentAngle - 2 * margin));
            
            // 3. Calculer la rotation totale (plusieurs tours + position)
            const spins = 5;
            const targetRotation = -(spins * 360 + randomPositionInSegment);
            
            // 4. Ajouter √† la rotation actuelle normalis√©e
            const newRotation = normalizedCurrentRotation + targetRotation;
            
            // Appliquer la rotation
            wheel.style.transform = `rotate(${newRotation}deg)`;
            currentRotation = newRotation;
            
            // Afficher le r√©sultat apr√®s l'animation
            setTimeout(() => {
                selectedPseudoDisplay.textContent = selectedPseudo.name;
                selectedPseudoDisplay.style.color = selectedPseudo.color;
                selectedPseudoDisplay.style.textShadow = `2px 2px 4px ${selectedPseudo.color}40`;
                
                // Ajouter √† l'historique
                addToHistory(selectedPseudo);
                
                // Retirer si n√©cessaire
                if (removeAfterSpin) {
                    removePseudo(selectedPseudo.id);
                }
                
                isSpinning = false;
                spinBtn.disabled = false;
                spinBtn.innerHTML = '<i class="fas fa-play"></i> Tourner la roue';
                spinCenter.innerHTML = 'TOURNEZ!';
                showFeedback(`${selectedPseudo.name} a √©t√© s√©lectionn√© !`);
            }, 4000);
        }

        // R√©initialiser la roue
        function resetWheel() {
            // R√©initialiser sans transition
            wheel.style.transition = 'none';
            wheel.style.transform = 'rotate(0deg)';
            currentRotation = 0;
            
            // Forcer un reflow
            void wheel.offsetWidth;
            
            // R√©activer la transition
            wheel.style.transition = `transform 4s cubic-bezier(0.2, 0.8, 0.3, 1)`;
            
            selectedPseudoDisplay.textContent = 'La roue n\'a pas encore √©t√© tourn√©e';
            selectedPseudoDisplay.style.color = '';
            selectedPseudoDisplay.style.textShadow = '';
        }

        // Ajouter √† l'historique
        function addToHistory(pseudo) {
            const now = new Date();
            const time = now.getHours().toString().padStart(2, '0') + ':' + 
                        now.getMinutes().toString().padStart(2, '0') + ':' +
                        now.getSeconds().toString().padStart(2, '0');
            
            history.unshift({
                name: pseudo.name,
                color: pseudo.color,
                time: time
            });
            
            if (history.length > 10) history.pop();
            updateHistory();
        }

        // Mettre √† jour l'historique
        function updateHistory() {
            if (history.length === 0) {
                historyList.innerHTML = '<div style="color: #999; text-align: center; padding: 10px;">Aucune s√©lection</div>';
                return;
            }
            
            let html = '';
            history.forEach(item => {
                html += `
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="width: 12px; height: 12px; border-radius: 50%; background-color: ${item.color};"></div>
                        <span style="font-weight: bold;">${item.name}</span>
                    </div>
                    <span style="color: #666; font-size: 0.9rem;">${item.time}</span>
                </div>
                `;
            });
            historyList.innerHTML = html;
        }

        // D√©finir le mode de retrait
        function setRemoveAfterSpin(remove) {
            removeAfterSpin = remove;
            const keepBtn = document.getElementById('keep-after-spin');
            const removeBtn = document.getElementById('remove-after-spin');
            
            if (remove) {
                keepBtn.className = 'btn btn-secondary';
                removeBtn.className = 'btn btn-danger';
            } else {
                keepBtn.className = 'btn btn-primary';
                removeBtn.className = 'btn btn-secondary';
            }
        }

        // Afficher un message temporaire
        function showFeedback(message) {
            const existingFeedback = document.querySelector('.feedback-message');
            if (existingFeedback) existingFeedback.remove();
            
            const feedback = document.createElement('div');
            feedback.className = 'feedback-message';
            feedback.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
                color: white;
                padding: 12px 24px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: bold;
                transition: opacity 0.3s;
            `;
            
            feedback.textContent = message;
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.style.opacity = '0';
                setTimeout(() => feedback.remove(), 300);
            }, 2000);
        }

        // SUPPRIMER TOUTES LES FONCTIONS DE SAUVEGARDE localStorage
        // Les fonctions saveToLocalStorage() et loadFromLocalStorage() ont √©t√© supprim√©es

        // Rendre les fonctions globales pour les √©v√©nements onclick
        window.changeColor = changeColor;
        window.removePseudo = removePseudo;
    </script>
</body>
</html>
